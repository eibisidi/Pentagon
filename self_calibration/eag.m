function Fx = eag(x)
global measures_ag t1s t2s;
Fx = zeros(size(measures_ag));
samples = length(measures_ag) / 2;

%Fx(1:samples) = measures_ag(1:samples) - sin(x(7)).*(1 - (x(1).*cos(x(5) + t1s).*(((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2)) - x(1).*sin(x(5) + t1s).*(((x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) - ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2))).^2./(x(1).^2.*x(2).^2)).^(1./2) - (cos(x(7)).*(x(1).*cos(x(5) + t1s).*(((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2)) - x(1).*sin(x(5) + t1s).*(((x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) - ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2))))./(x(1).*x(2));
%Fx(samples + 1:2*samples) = measures_ag(samples + 1:2*samples) - sin(x(8)).*(1 - (x(3).*cos(x(6) + t2s).*(x(1).*cos(x(5) + t1s) - x(3).*cos(x(6) + t2s) + ((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2) - 200) + x(3).*sin(x(6) + t2s).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s) - ((x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2))).^2./(x(3).^2.*x(4).^2)).^(1./2) - (cos(x(8)).*(x(3).*cos(x(6) + t2s).*(x(1).*cos(x(5) + t1s) - x(3).*cos(x(6) + t2s) + ((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2) - 200) + x(3).*sin(x(6) + t2s).*(x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s) - ((x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).*(x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))./(2.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2)) + ((x(2).^2 - (x(2).^2 - x(4).^2 + (x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^2./(4.*((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2))).^(1./2).*(x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200))./((x(3).*cos(x(6) + t2s) - x(1).*cos(x(5) + t1s) + 200).^2 + (x(1).*sin(x(5) + t1s) - x(3).*sin(x(6) + t2s)).^2).^(1./2))))./(x(3).*x(4));

Fx(1:samples) = measures_ag(1:samples) - cose1_func(x, t1s, t2s);
Fx(samples + 1:2*samples) = measures_ag(samples + 1:2*samples) - cose2_func(x, t1s, t2s);
end


